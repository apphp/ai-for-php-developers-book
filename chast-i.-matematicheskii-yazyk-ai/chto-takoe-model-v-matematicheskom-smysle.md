---
description: Функция, параметры, ошибка.
---

# Что такое модель в математическом смысле

Когда мы говорим о модели в машинном обучении, полезно сразу отбросить все ассоциации с "искусственным интеллектом" и сложными абстракциями. В математическом смысле модель – это функция. Не больше и не меньше. Она принимает какие-то входные данные и возвращает результат. Различие заключается в том, что функция не является жёстко заданной и допускает настройку параметров.

Проще всего это понять, если думать как PHP-разработчик. Любая модель очень похожа на обычный метод или функцию, которую вы пишете каждый день. Есть входные аргументы, есть вычисления внутри и есть возвращаемое значение.

В самом общем виде модель можно записать так:

$$
f(x) = ŷ
$$

Здесь x – входные данные, а ŷ – предсказание модели. Черта над y неслучайна: это не истинное значение, а лишь попытка его угадать.

### **Функция как основа модели**

Допустим, мы хотим предсказывать цену квартиры по ее площади. В простейшем случае модель можно взять линейную:

$$
ŷ = w · x + b
$$

Это уже полноценная модель. Она говорит: "Цена ($$ŷ$$) примерно равна площади ($$x$$), умноженной на некий коэффициент ($$w$$), плюс некий сдвиг ($$b$$)".&#x20;

Если переписать это на PHP, получится почти банальный код:

```php
class LinearModel {
    public float $w;
    public float $b;

    public function __construct(float $w, float $b) {
        $this->w = $w;
        $this->b = $b;
    }

    public function predict(float $x): float {
        return $this->w * $x + $this->b;
    }
}
```

Пример:

```php
$model = new LinearModel(2.0, 0.0);
echo $model->predict(3.0);

// Результат: 6
// Объяснение: 2 * 3 + 0 = 6 
```

С точки зрения PHP это обычный класс. Никакой магии. Но с точки зрения машинного обучения – это модель.

**Параметры модели**

Ключевой момент здесь – параметры. В нашем примере это ($$w$$) и ($$b$$). Они не являются входными данными, но именно от них зависит поведение модели. Если изменить ($$w$$) или ($$b$$), функция начнет выдавать другие результаты.

Важно четко разделять:

* входные данные ($$x$$) – то, что приходит "снаружи";
* параметры ($$w$$, $$b$$) – то, что живет внутри модели и настраивается;
* выход ($$ŷ$$) – результат работы модели.

В обычном программировании вы чаще всего задаете параметры жестко в коде. В машинном обучении все наоборот: структура функции фиксирована, а параметры подбираются автоматически.

### **Ошибка как мера качества**

Теперь возникает главный вопрос: как понять, что одни параметры лучше других? Для этого вводится понятие ошибки, или функции потерь.

Ошибка – это функция (общепринятое название - [Loss function](../vvedenie/glossarii.md#loss-funkciya)), которая сравнивает предсказание модели с реальным значением и возвращает число, показывающее, насколько мы ошиблись. Чем меньше это число, тем лучше модель.

Например, самая простая ошибка – разница между предсказанием и реальностью:

$$
ŷ ​- y
$$

```php
function error(float $yTrue, float $yPredicted): float {
    return $yPredicted - $yTrue;
}
```

Пример:

```php
echo error(yTrue: 10.0, yPredicted: 7.0);

// Результат: -3 
// Объяснение: 7 - 10 = -3
```

На практике чаще используют квадрат ошибки (Squared Error или SE), потому что он всегда положительный и сильнее наказывает большие промахи:

$$
(ŷ − y​) ^ 2
$$

```php
function squaredError(float $yTrue, float $yPredicted): float {
    return ($yPredicted - $yTrue) ** 2;
}
```

Пример:

```php
echo squaredError(yTrue: 4.0, yPredicted: 6.0);

// Результат: 4 
// Объяснение: (6 - 4)² = 4
```

Обратите внимание на важный момент. Ошибка напрямую зависит от `$yPredicted`, а `$yPredicted` зависит от параметров модели. Значит, в конечном итоге ошибка – это функция от параметров модели.

### **Обучение как минимизация ошибки**

Если собрать все вместе, картина становится очень простой и приземленной.

У нас есть:

* модель – функция с параметрами;
* данные – пары входов и правильных ответов;
* ошибка – способ измерить качество предсказаний.

Обучение модели – это процесс подбора таких параметров, при которых суммарная ошибка на данных становится минимальной.

Даже в PHP это легко представить в виде цикла. Примитивно и неэффективно, но концептуально верно:

```php
$dataset = [
    [1.0, 2.0],
    [2.0, 4.0],
];

$model = new LinearModel(w: 0.0, b: 0.0);

foreach ($dataset as [$x, $yTrue]) {
    $yPredicted = $model->predict($x);
    $loss = squaredError($yTrue, $yPredicted);

    // здесь в реальных алгоритмах параметры
    // изменяются так, чтобы loss уменьшился
}

// Результат:
x = 1, yTrue = 2, yPredicted = 0, loss = 4
x = 2, yTrue = 4, yPredicted = 0, loss = 16
```

Пример:

```php
// Плохая модель (до обучения)
$model = new LinearModel(w: 0.0, b: 0.0)
// y = 0 * x
// Результат:
// x = 1, yTrue = 2, yPredicted = 0, loss = 4
// x = 2, yTrue = 4, yPredicted = 0, loss = 16

// Улучшенная модель (после нескольких "шагов обучения")
$model = new LinearModel(w: 0.8, b: 0.0);
// y = 0.8 * x
// Результат:
// x = 1, yTrue = 2, yPredicted = 0.8, loss = 1.44
// x = 2, yTrue = 4, yPredicted = 2.4, loss = 5.76

// и так далее, параметры изменяются так, чтобы loss уменьшился
```

Конкретный способ изменения параметров – это уже вопрос алгоритмов оптимизации, о которых мы будем говорить отдельно. Но важно уловить саму идею: никто не "объясняет" модели правила. Мы лишь говорим ей, насколько она ошиблась, и позволяем постепенно уменьшать эту ошибку.

### **Почему это понимание критично**

Для PHP-разработчика такое представление особенно ценно. Оно показывает, что машинное обучение не противоречит классическому программированию и не заменяет его. Напротив, оно опирается на те же самые базовые идеи: функции, параметры, вычисления.

Модель – это не черный ящик. Это функция.

Обучение – это не магия. Это оптимизация.

Ошибка – это не абстракция. Это обычная функция, возвращающая число.

Если вы это поняли, то страх перед машинным обучением уже исчез. Дальше начинается инженерия: какие функции брать, какие ошибки использовать и как эффективно подбирать параметры.

{% hint style="info" %}
Чтобы самостоятельно протестировать этот код, установите примеры из официального репозитория [GitHub](https://github.com/apphp/ai-for-php-developers-examples) или воспользуйтесь [онлайн-демонстрацией](https://aiwithphp.org/books/ai-for-php-developers/examples/part-1/what-is-a-model) для его запуска.
{% endhint %}
